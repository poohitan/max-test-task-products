(this["webpackJsonpmax-test-task"]=this["webpackJsonpmax-test-task"]||[]).push([[0],{100:function(e,t,c){"use strict";c.r(t);var n=c(0),r=c.n(n),a=c(24),i=c.n(a),d=(c(81),c(9)),o=c(17),s=c(8),j=c(119),l=c(134),u=c(47),b=c(120),m=c(121),O=c(127),x=c(131),p=c(129),h=c(32),g=c.n(h),f=c(113),v=c(136),S=c(115),w=c(128),I=c(137),y=c(123),k=c(116),A=c(117),P=c(25),C=Object(P.b)({name:"products",initialState:[],reducers:{create:function(e,t){e.push(t.payload)},update:function(e,t){var c=e.findIndex((function(e){return e.id===t.payload.id}));e.splice(c,1,t.payload)},remove:function(e,t){var c=e.findIndex((function(e){return e.id===t.payload}));e.splice(c,1)}}}),D=C.actions,N=D.create,z=D.update,E=D.remove,J=C.reducer,L=(c(87),c(3)),R=function(e){var t=e.id,c=e.name,n=e.description,r=e.image,a=Object(d.b)(),i=Object(d.c)((function(e){return e.comments.filter((function(e){return e.productId===t}))}));return Object(L.jsxs)(f.a,{direction:"column",background:"light-1",className:"product",children:[Object(L.jsx)(v.a,{pad:"medium",background:"light-2",children:Object(L.jsx)(o.b,{to:"/products/".concat(t),children:Object(L.jsx)(O.a,{level:"3",margin:"none",children:c})})}),Object(L.jsxs)(S.a,{direction:"row",fill:!0,pad:"medium",gap:"medium",className:"product-description",children:[r?Object(L.jsx)(u.a,{width:"xsmall",children:Object(L.jsx)(w.a,{fit:"cover",src:r,fill:!0})}):null,n]}),Object(L.jsxs)(I.a,{pad:{horizontal:"medium"},background:"light-2",children:[Object(L.jsx)(p.a,{size:"small",children:g()("Comment",i.length,!0)}),Object(L.jsxs)(u.a,{direction:"row",children:[Object(L.jsx)(o.b,{to:"/products/".concat(t,"/edit"),children:Object(L.jsx)(y.a,{icon:Object(L.jsx)(k.a,{color:"plain"}),hoverIndicator:!0,title:"Edit Product"})}),Object(L.jsx)(y.a,{icon:Object(L.jsx)(A.a,{color:"red"}),hoverIndicator:!0,title:"Remove Product",onClick:function(){return a(E(t))}})]})]})]})};R.defaultProps={description:"",image:""};var F=R;var B=function(){var e=Object(d.c)((function(e){return e.products}));return Object(L.jsxs)("div",{children:[Object(L.jsx)(O.a,{children:"Product List"}),Object(L.jsx)(x.a,{gap:"medium",columns:{count:"fit",size:"medium"},children:e.length?e.map((function(e){return Object(L.jsx)(F,{id:e.id,name:e.name,description:e.description,image:e.image},e.id)})):Object(L.jsx)(p.a,{margin:"none",children:"There are currently no products"})})]})},M=c(44),T=c.n(M),U=c(71),q=c(29),G=c(126),H=c(139),K=c(122),Q=c(125),V=c(132),W=c(133);function X(e){return new Promise((function(t,c){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return c(e)}}))}var Y=function(e){var t=e.product,c=Object(n.useState)(t),r=Object(q.a)(c,2),a=r[0],i=r[1],o=Object(d.b)(),j=Object(s.f)(),l=function(){var e=Object(U.a)(T.a.mark((function e(c){var n,r,a,i,d,s,l,u;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.id,r=c.name,a=c.description,i=c.files,d=void 0===i?[]:i,s=Object(q.a)(d,1),!(l=s[0])){e.next=8;break}return e.next=5,X(l);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=t.image;case 9:if(u=e.t0,!n){e.next=14;break}return o(z({id:n,name:r,description:a,image:u,updatedAt:(new Date).toISOString()})),j.push("/products/".concat(n)),e.abrupt("return");case 14:o(N({id:Object(G.a)(),name:r,description:a,image:u,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()})),j.push("/");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(L.jsxs)(H.a,{value:a,onChange:function(e){return i(e)},onSubmit:function(e){var t=e.value;return l(t)},children:[Object(L.jsxs)(u.a,{direction:"column",gap:"small",width:"large",children:[Object(L.jsx)(K.a,{name:"name",label:"Name",validate:{regexp:/\S+/,message:"Name can't be empty"},children:Object(L.jsx)(Q.a,{name:"name"})}),Object(L.jsx)(K.a,{name:"description",label:"Description",validate:{regexp:/\S+/,message:"Description can't be empty"},children:Object(L.jsx)(V.a,{name:"description"})}),Object(L.jsx)(K.a,{name:"image",label:"Image",children:Object(L.jsx)(W.a,{name:"files",multiple:!1,accept:"image/*"})})]}),Object(L.jsx)(u.a,{direction:"row",gap:"medium",children:Object(L.jsx)(y.a,{type:"submit",size:"large",primary:!0,label:"Save"})})]})};Y.defaultProps={product:{name:"",description:""}};var Z=Y;var $=function(){var e=Object(s.g)().id,t=Object(d.c)((function(t){return t.products.find((function(t){return t.id===e}))}));if(e&&!t)return Object(L.jsxs)(p.a,{alignSelf:"center",fill:!0,margin:"none",color:"status-error",children:["Product with ID\xa0",Object(L.jsx)("b",{children:e}),"\xa0doesn't exist."]});var c=t?Object(L.jsxs)(O.a,{children:["Edit\xa0",Object(L.jsxs)("b",{children:['"',t.name,'"']})]}):Object(L.jsx)(O.a,{children:"Create Product"});return Object(L.jsxs)(L.Fragment,{children:[c,Object(L.jsx)(Z,{product:t})]})},_=c(30),ee=Object(P.b)({name:"comments",initialState:[],reducers:{create:function(e,t){e.push(t.payload)},remove:function(e,t){var c=e.findIndex((function(e){return e.id===t.payload}));e.splice(c,1)}}}),te=ee.actions,ce=te.create,ne=te.remove,re=ee.reducer,ae=function(e){var t=e.productId,c=Object(n.useState)(),r=Object(q.a)(c,2),a=r[0],i=r[1],o=Object(d.b)();return Object(L.jsxs)(H.a,{value:a,onChange:function(e){return i(e)},onSubmit:function(e){var c,n=e.value;return c=n,o(ce(Object(_.a)({id:Object(G.a)(),productId:t,createdAt:(new Date).toISOString()},c))),void i({text:""})},children:[Object(L.jsx)(u.a,{direction:"column",gap:"small",children:Object(L.jsx)(K.a,{name:"text",validate:{regexp:/\S+/,message:"Comment text can't be empty"},children:Object(L.jsx)(V.a,{name:"text"})})}),Object(L.jsx)(u.a,{direction:"row",gap:"medium",children:Object(L.jsx)(y.a,{type:"submit",primary:!0,label:"Add Comment"})})]})},ie=function(e){var t=e.id,c=e.text,n=e.createdAt,r=Object(d.b)();return Object(L.jsxs)(f.a,{direction:"column",background:"light-1",children:[Object(L.jsx)(S.a,{fill:!0,pad:"small",children:Object(L.jsx)(p.a,{margin:"none",children:c})}),Object(L.jsxs)(I.a,{pad:{horizontal:"small"},background:"light-2",children:[Object(L.jsx)(p.a,{size:"small",margin:"none",children:new Date(n).toLocaleString()}),Object(L.jsx)(y.a,{icon:Object(L.jsx)(A.a,{color:"red",size:"small"}),hoverIndicator:!0,title:"Remove Comment",onClick:function(){return r(ne(t))}})]})]})};c(99);var de=function(){var e=Object(s.g)().id,t=Object(d.c)((function(t){return t.products.find((function(t){return t.id===e}))})),c=Object(d.c)((function(t){return t.comments.filter((function(t){return t.productId===e}))})).reverse();if(!t)return Object(L.jsxs)(p.a,{alignSelf:"center",fill:!0,margin:"none",color:"status-error",children:["Product with ID\xa0",Object(L.jsx)("b",{children:e}),"\xa0doesn't exist."]});var n=c.length?g()("Comment",c.length,!0):"No comments yet";return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)(u.a,{direction:"row",align:"center",children:[Object(L.jsx)(O.a,{margin:"bottom",children:t.name}),Object(L.jsx)(o.b,{to:"/products/".concat(e,"/edit"),children:Object(L.jsx)(y.a,{type:"submit",label:"Edit",margin:{left:"large"}})})]}),Object(L.jsxs)(u.a,{direction:"row",margin:{bottom:"large"},gap:"medium",children:[t.image?Object(L.jsx)(u.a,{width:"medium",children:Object(L.jsx)(w.a,{fit:"contain",src:t.image,fill:!0})}):null,Object(L.jsx)(p.a,{width:"70%",margin:"none",className:"product-description",children:t.description})]}),Object(L.jsxs)(u.a,{border:{color:"brand",size:"medium"},pad:"medium",gap:"medium",width:"large",children:[Object(L.jsx)(O.a,{level:"4",margin:"none",children:n}),Object(L.jsx)(ae,{productId:e}),c.map((function(e){return Object(L.jsx)(ie,{id:e.id,text:e.text,createdAt:e.createdAt},e.id)}))]})]})};var oe=function(){return Object(L.jsx)("div",{className:"App",children:Object(L.jsxs)(o.a,{children:[Object(L.jsxs)(j.a,{direction:"row",background:"brand",pad:"medium",children:[Object(L.jsx)(o.b,{to:"/",children:Object(L.jsx)(l.a,{icon:Object(L.jsx)(b.a,{}),label:"Product List"})}),Object(L.jsx)(o.b,{to:"/products/new",children:Object(L.jsx)(l.a,{icon:Object(L.jsx)(m.a,{}),label:"Add Product"})})]}),Object(L.jsx)(u.a,{direction:"column",pad:"medium",children:Object(L.jsxs)(s.c,{children:[Object(L.jsx)(s.a,{path:"/",exact:!0,children:Object(L.jsx)(B,{})}),Object(L.jsx)(s.a,{path:"/products/new",exact:!0,children:Object(L.jsx)($,{})}),Object(L.jsx)(s.a,{path:"/products/:id/edit",exact:!0,children:Object(L.jsx)($,{})}),Object(L.jsx)(s.a,{path:"/products/:id",exact:!0,children:Object(L.jsx)(de,{})})]})})]})})},se=localStorage.getItem("state")?JSON.parse(localStorage.getItem("state")):{},je=Object(P.a)({reducer:{products:J,comments:re},preloadedState:se});je.subscribe((function(){localStorage.setItem("state",JSON.stringify(je.getState()))}));var le=je;i.a.render(Object(L.jsx)(r.a.StrictMode,{children:Object(L.jsx)(d.a,{store:le,children:Object(L.jsx)(oe,{})})}),document.getElementById("root"))},81:function(e,t,c){},87:function(e,t,c){},99:function(e,t,c){}},[[100,1,2]]]);
//# sourceMappingURL=main.7c611364.chunk.js.map